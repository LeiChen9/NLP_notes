# 2020 腾讯广告算法大赛Top方案

## 赛题介绍
用广告系统中的用户交互行为来预测人口统计学特征

对于缺乏用户信息的系统，通过推断用户属性可以实现更好的用户画像

## 赛题理解
- 数据
  - 3个月时间窗口内的广告点击历史记录：日期（1 - 91）、用户信息（age，gender）、被点击的广告的信息（素材id、广告id、产品id、产品类目id、广告主id、广告主行业id），用户当天点击该广告的次数
- 目标
  - age & gender
- 评价指标
  - accuracy

## 特征工程
- 统计特征
  - 用户出现的总次数，天数
  - 用户点击广告的总次数
  - 用户点击不同广告、产品、类别、素材、广告主的总数
  - 用户每天每条广告点击的平均次数，均值和方差
- 概率分布特征
  - 五折交叉的target encoding -> 统计每个广告受众人群的性别年龄分布 ->(avg) 该用户性别年龄的概率分布

## 模型设计
每个广告看成一个**单词**，那么用户点击序列就是**一句话**。所以这个问题就变成了**文本分类**问题。

通过BERT进行编码，但是广告有稀疏性，词表很难load到GPU里，也很难收敛。

### 预训练
#### word2vector
把用户点击广告序列输入到embedding层，然后预测广告id。
- 问题
  - 只是使用了一个广告预测另一个广告，没有使用更多广告进行预测，缺失上下文信息
  - 没有利用广告本身属性进行预测，like 类别信息
#### Masked Language Modeling
只mask广告的一部分（广告id或属性），随机mask掉20%的token。

在预测id的时候，不仅可以使用之前之后点击的广告，也可以用属性去预测

### 融合层
把点击广告的受众人群性别年龄分布融合到网络中

### 输出层
mean pooling & max pooling -> batch norm layer -> mlp + softmax

